# InfraProject (현재 작업중....주말(02/06)에 windows cp949타입 추가예정)
- 인프라진단 스크립트 실행 후 텍스트 결과물을 엑셀로 Copy&Paste 시간을 줄이기 위해 만들었습니다.
- 선택된 폴더의 텍스트 파일명을 기반으로 지정된 영역을 파싱하여 지정된 엑셀의 동일이름을 가진 워크시트에 자동으로 입력해줍니다.
- 워크시트가 존재하지 않는 경우 새로 생성됩니다.
- 직관적인 사용가이드는 하단의 유튜브 영상을 참고해주시기 바랍니다.

# 설치
- 스크립트를 실행하려면 파이썬3가 설치되어있어야하며 사용되는 라이브러리를 모두 설치해주셔야합니다.
- pyinstaller를 활용하여 exe파일로 배포하려했는데 실패하였습니다. 성공하신 분은 알려주시면 감사하겠습니다.
```
git clone https://github.com/bbakbbak2/InfraProject.git
pip install pyqt5
pip install openpyxl
pip install configparser
```
# 실행
```
python main.py
```

# 설명
1. 사용하시는 쉘 스크립트 파일(windows.bat, linux.sh)에 적절한 파싱 문자열이 존재해야합니다.
2. 파싱문자열이 없는 경우 사용하시는 쉘 스크립트에 직접 입력하신 후 해당 텍스트 결과물을 사용하시면 됩니다.
3. InfraProject는 입력된 파싱문자열을 기반으로 내용을 엑셀파일에 복사하게 됩니다. (*정규표현식 지원됨)
4. 작업전 원본 엑셀은 백업해두시기 바랍니다. 
5. 엑셀파일이 열려있는 경우 에러가 발생하므로 꼭 종료 후 실행해주시기 바랍니다.

# 소스&파일
- main.py: GUI를 구현한 코드입니다.
- parsing.py: 파싱코드가 존재합니다.
- config.ini : 현재 설정을 저장하고 재사용할 수 있습니다.


# 메뉴내용
1. 엑셀파일 선택: 결과물을 입력할 엑셀 파일을 선택합니다. 원본엑셀을 백업하고 작업하시길 추천드립니다.
2. 텍스트 디렉토리 선택: 결과물 텍스트 파일들을 한곳에 모아두어서 지정하는 것이 좋습니다.
3. 파싱시작/종료 문자열: 파싱을 원하는 포인트를 지정합니다. (*정규표현식 지원됨)
4. 셀 위치 열/행: 첫 시작 열과 행을 조절 할 수 있습니다.
5. 셀 너비/높이: 너비와 높이를 지정할 수 있습니다.

# 유튜브 영상 가이드
- https://youtu.be/SONgc_J6svs

# 이슈/버그
- 이슈사항에 대해 상단의 Issue에 남겨주시면 검토하도록 하겠습니다.
- 아쉽게도 UTF-8 인코딩외 다른 텍스트 파일의 지원이 불가능합니다...ㅠㅠ
- 윈도우즈의 배치 스크립트의 경우 디폴트 인코딩 형태가 cp949 또는 euc-kr로 저장되기 때문에 UTF-8로 변환이 필요합니다.
- notepad+ 또는 워드패드로 실행하여 UTF-8로 변환하면 사용가능합니다.
- 일부 특수문자가 셀에 기록될 경우 워크시트 깨짐현상이 발생합니다.
- 현재 파악된 지원되지 않는 특수문자는 =가 두번 이상들어간 경우입니다. 해당 문자열이 들어간 부분의 파싱은 피해주세요.


